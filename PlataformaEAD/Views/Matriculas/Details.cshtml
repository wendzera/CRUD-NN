@model PlataformaEAD.Models.Matricula

@{
    ViewData["Title"] = "Detalhes da Matrícula";
}

<div class="container">
    <h1>Detalhes da Matrícula</h1>

    <div class="row">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h5>@Model.Aluno.Nome - @Model.Curso.Titulo</h5>
                </div>
                <div class="card-body">
                    <dl class="row">
                        <dt class="col-sm-4">Aluno:</dt>
                        <dd class="col-sm-8">
                            <i class="fas fa-user"></i> @Model.Aluno.Nome
                            @if (!string.IsNullOrEmpty(Model.Aluno.Email))
                            {
                                <br><small class="text-muted">@Model.Aluno.Email</small>
                            }
                        </dd>
                        
                        <dt class="col-sm-4">Curso:</dt>
                        <dd class="col-sm-8">
                            <i class="fas fa-book"></i> @Model.Curso.Titulo
                            <br><small class="text-muted">@Model.Curso.CargaHoraria horas - Preço base: R$ @Model.Curso.PrecoBase.ToString("N2")</small>
                        </dd>
                        
                        <dt class="col-sm-4">Data da Matrícula:</dt>
                        <dd class="col-sm-8">@Model.Data.ToString("dd/MM/yyyy HH:mm")</dd>
                        
                        <dt class="col-sm-4">Preço Pago:</dt>
                        <dd class="col-sm-8">
                            <strong>R$ @Model.PrecoPago.ToString("N2")</strong>
                            @if (Model.PrecoPago != Model.Curso.PrecoBase)
                            {
                                @if (Model.PrecoPago < Model.Curso.PrecoBase)
                                {
                                    <span class="badge bg-success">Desconto</span>
                                }
                                else
                                {
                                    <span class="badge bg-warning">Acima do preço base</span>
                                }
                            }
                        </dd>
                        
                        <dt class="col-sm-4">Status:</dt>
                        <dd class="col-sm-8">
                            @switch (Model.Status)
                            {
                                case PlataformaEAD.Models.StatusMatricula.Ativo:
                                    <span class="badge bg-success fs-6">
                                        <i class="fas fa-check-circle"></i> Ativo
                                    </span>
                                    break;
                                case PlataformaEAD.Models.StatusMatricula.Concluido:
                                    <span class="badge bg-primary fs-6">
                                        <i class="fas fa-trophy"></i> Concluído
                                    </span>
                                    break;
                                case PlataformaEAD.Models.StatusMatricula.Cancelado:
                                    <span class="badge bg-danger fs-6">
                                        <i class="fas fa-times-circle"></i> Cancelado
                                    </span>
                                    break;
                            }
                        </dd>
                        
                        <dt class="col-sm-4">Progresso:</dt>
                        <dd class="col-sm-8">
                            <div class="progress mb-2" style="height: 25px;">
                                <div class="progress-bar @(Model.Progresso == 100 ? "bg-success" : Model.Progresso >= 75 ? "bg-info" : Model.Progresso >= 50 ? "bg-warning" : "bg-secondary") progress-bar-striped" 
                                     role="progressbar" style="width: @Model.Progresso%;">
                                    @Model.Progresso%
                                </div>
                            </div>
                        </dd>
                        
                        <dt class="col-sm-4">Nota Final:</dt>
                        <dd class="col-sm-8">
                            @if (Model.NotaFinal.HasValue)
                            {
                                <span class="badge @(Model.NotaFinal >= 7 ? "bg-success" : Model.NotaFinal >= 5 ? "bg-warning" : "bg-danger") fs-6">
                                    @Model.NotaFinal.Value.ToString("N2")
                                </span>
                                @if (Model.NotaFinal >= 7)
                                {
                                    <small class="text-success">
                                        <i class="fas fa-star"></i> Aprovado
                                    </small>
                                }
                                else if (Model.NotaFinal >= 5)
                                {
                                    <small class="text-warning">
                                        <i class="fas fa-exclamation-triangle"></i> Recuperação
                                    </small>
                                }
                                else
                                {
                                    <small class="text-danger">
                                        <i class="fas fa-times"></i> Reprovado
                                    </small>
                                }
                            }
                            else
                            {
                                <span class="text-muted">Não avaliado</span>
                            }
                        </dd>
                    </dl>
                </div>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="card">
                <div class="card-header">
                    <h6>Estatísticas</h6>
                </div>
                <div class="card-body">
                    <div class="text-center">
                        <div class="mb-3">
                            <div class="fs-1 @(Model.Progresso == 100 ? "text-success" : Model.Progresso >= 50 ? "text-warning" : "text-secondary")">
                                @Model.Progresso<small class="fs-6">%</small>
                            </div>
                            <small class="text-muted">Progresso do Curso</small>
                        </div>
                        
                        @if (Model.NotaFinal.HasValue)
                        {
                            <div class="mb-3">
                                <div class="fs-1 @(Model.NotaFinal >= 7 ? "text-success" : Model.NotaFinal >= 5 ? "text-warning" : "text-danger")">
                                    @Model.NotaFinal.Value.ToString("N1")
                                </div>
                                <small class="text-muted">Nota Final</small>
                            </div>
                        }
                        
                        <div class="mb-3">
                            <div class="fs-4 text-info">
                                @Model.Curso.CargaHoraria<small class="fs-6">h</small>
                            </div>
                            <small class="text-muted">Carga Horária</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="mt-4">
        <a asp-action="Edit" asp-route-alunoId="@Model.AlunoId" asp-route-cursoId="@Model.CursoId" class="btn btn-warning">
            <i class="fas fa-edit"></i> Editar
        </a>
        <a asp-action="Index" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Voltar à Lista
        </a>
        <a asp-controller="Alunos" asp-action="Details" asp-route-id="@Model.AlunoId" class="btn btn-outline-info">
            <i class="fas fa-user"></i> Ver Aluno
        </a>
        <a asp-controller="Cursos" asp-action="Details" asp-route-id="@Model.CursoId" class="btn btn-outline-info">
            <i class="fas fa-book"></i> Ver Curso
        </a>
    </div>
</div>